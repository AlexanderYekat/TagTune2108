# **Руководство по использованию "TagTune 2108" для коррекции чеков (тег 2108)**

Это руководство должно облегчить вам процесс коррекции чеков для исправления ошибки с непереданным тегом 2108 (мера измерения). 

Процесс разбит на два этапа: подготовка данных и печать чеков.

## Этап 1: Подготовка данных

### Получение и подготовка отчетов

1. **Извлечение отчетов из ОФД**:
   - Вам нужно получить два типа отчетов в формате XLS:
     - Отчет о карантинных чеках.
     - Детальный отчет по товарам.

   Убедитесь, что отчет о карантинных чеках содержит только карантинные чеки.

2. **Преобразование отчетов в формат CSV**:
   - Откройте отчет о карантинных чеках с помощью LibreOffice Calc.
   - Удалите все лишнее, оставив только заголовки столбцов.
   - Сохраните файл как `checks_header.csv`, выберите формат "Текст CSV (*.csv)" и активируйте "Изменить настройки фильтра".
   - Повторите процедуру для детального отчета по товарам, сохраняя его как `checks_poss.csv`.

### Создание JSON-файлов

1. **Запуск программы**:
   - Поместите оба файла CSV (`checks_poss.csv` и `checks_header.csv`) в папку `\xlstojson\infiles`.
   - Убедитесь, что папка `\xlstojson\json` пуста.
   - Запустите `checkcorr2.exe` из папки `xlstojson` и следуйте инструкциям на экране.
   - После завершения в папке `\xlstojson\json` появятся готовые JSON-файлы для печати.

## Этап 2: Печать чеков коррекции

### Подготовка к печати

1. **Подготовка JSON-файлов**:
   - Перенесите JSON-файлы из `\xlstojson\json` в `\jsons\works\`.
   - В `\jsons\works\` создайте файл `connection.txt` и укажите номер COM-порта кассы.

### Процесс печати

1. **Печать чеков**:
   - Запустите программу `jsontokkt.exe` из папки `jsontokkt`. Чеки автоматически начнут печататься.

### Учёт и контроль

1. **Отслеживание напечатанных чеков**:
   - Все успешно напечатанные чеки сохраняются в файле `printed.txt` в папке `\jsons\works\`.
   - При каждом новом запуске программы уже напечатанные чеки будут пропускаться.
