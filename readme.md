## **Инструкция по использованию программы для формирования чеков коррекции**

**Процесс создания чеков коррекции делится на два основных этапа:**

### **Этап 1: Формирование JSON-заданий для кассы**

1. **Получение отчетов из ОФД**
   - Необходимо извлечь из ОФД два типа отчетов в формате XLS:
     - Отчет о карантинных чеках.
     - Детальный отчет по всем товарам.
   - Важно, чтобы отчет о карантинных чеках содержал исключительно карантинные чеки.

2. **Перевод отчетов из XLS в CSV**
   - Открыть отчет о карантинных чеках в LibreOffice Calc.
   - Удалить все данные до названий столбцов (сами названия столбцов оставить).
   - Сохранить файл как `checks_header.csv`, выбрав тип файла "Текст CSV (*.csv)" и включив опцию "Изменить настройки фильтра".
   - Для отчета о товарах важно включить опцию "Сохранять формулы ячеек вместо вычисленных значений".
   - Повторить процедуру для детального отчета по товарам, сохраняя его как `checks_poss.csv`.

3. **Запуск программы для создания JSON-файлов**
   - Переместить оба CSV файла (`checks_poss.csv` и `checks_header.csv`) в папку `\xlstojson\infiles`.
   - Очистить папку `\xlstojson\json`.
   - Запустить программу `checkcorr2.exe` из папки `xlstojson`, следуя инструкциям для выбора ОФД и ввода необходимой информации.
   - После завершения работы программы, задания в формате JSON появятся в папке `\xlstojson\json`.

### **Этап 2: Отбитие чеков коррекции на кассе**

1. **Подготовка JSON-файлов**
   - Переместить JSON-файлы из папки `\xlstojson\json` в папку `\jsons\works\` второй программы.
   - В папке `\jsons\works\` создать файл `connection.txt` и указать в первой строке номер COM порта кассы.

2. **Печать чеков коррекции**
   - Запустить программу `jsontokkt.exe` из папки `jsontokkt`. Чеки начнут печататься на кассовом аппарате.

3. **Учёт напечатанных чеков**
   - Все успешно напечатанные чеки будут сохраняться в файле `printed.txt` в папке `\jsons\works\`.
   - При повторном запуске программа будет игнорировать уже напечатанные чеки, переходя к следующим в очереди.
